$(function() {
	var whoami=null;
	FrontEnd.displayPage('pageLogin');
	

	config = {
				'type': 'POST',
				'url': '/',
				'data': {
					'action': 'whoami'
				},
				'success': function(reponse){
					console.log(reponse);
					if(reponse==null)
						FrontEnd.displayPage('pageLogin');
					else{
						whoami = reponse;
						FrontEnd.displayPage('pageCongrats');
					}
				},
				'error' : function(e) {
					console.log(reponse);
					FrontEnd.displayPage('pageLogin');
				}
			}
	FrontEnd.ajax(config);

	
	
	$('#btnLogin').click(function(){
		//console.log('Test');
		var username = $('#inputLogin').val();
		var password = $('#inputMdp').val();
		
		config = {
					'type': 'POST',
					'url': '/',
					'data': {
								'action': 'signin',
								'user': username,
								'pswd': password
							},
					'success': function(reponse){
									if(reponse == "ok"){
										console.log("OK");
										whoami = $('#inputLogin').val();
										FrontEnd.displayPage('pageCongrats');
									} else {
										console.log("KO");
										FrontEnd.displayPage('pageLogin');
									}
								},
					'error': function(reponse){
								console.log("KO");
								FrontEnd.displayPage('pageLogin');
							}
				 }
		FrontEnd.ajax(config);
	});
	
	FrontEnd.onDisplayPage('pageCongrats', function(){
		$('#whoami').text(whoami);
	});

});