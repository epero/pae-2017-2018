package biz.ucc;

import biz.user.UserBiz;
import biz.user.UserDto;
import dal.dao.UserDao;
import util.AppContext.DependanceInjection;
import util.Util;

class UserUccImpl implements UserUcc {

  @DependanceInjection
  private UserDao userDao;

  @Override
  public UserDto seConnecter(String pseudo, String mdp) {

    try {
      Util.checkString(pseudo);
      Util.checkString(mdp);
    } catch (IllegalArgumentException ex) {
      return null;
    }

    UserBiz userAVerf = (UserBiz) userDao.getUser(pseudo);

    if (userAVerf != null && userAVerf.verifierMotDePasse(mdp)) {
      return userAVerf;
    }
    return null;
  }
}
