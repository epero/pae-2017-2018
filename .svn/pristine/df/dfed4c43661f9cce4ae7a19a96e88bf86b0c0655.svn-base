package biz.ucc;

import static org.junit.Assert.assertNotNull;
import java.time.LocalDate;
import org.junit.Before;
import org.junit.Test;
import biz.factory.BizFactory;
import biz.stage.StageDto;
import exceptions.BizException;
import exceptions.FatalException;
import exceptions.OptimisticLockException;
import util.AppContext;
import util.AppContext.DependanceInjection;

public class StageUccImplTest {

  @DependanceInjection
  private StageUcc stageUcc;
  @DependanceInjection
  private BizFactory factory;

  private StageDto stageAVerif;


  @Before
  public void setUp() throws Exception {
    AppContext appContext = new AppContext();
    appContext.loadProps("test.properties");
    appContext.recurDepInj(this);
    stageAVerif = factory.getStageVide();
  }

  @Test
  public void testGetStage01() {
    assertNotNull(stageUcc.visualiserStage(1));
  }

  @Test
  public void testGetStage02() {
    assertNotNull(stageUcc.visualiserStage(998));
  }

  @Test(expected = BizException.class)
  public void testGetStage03() {
    stageUcc.visualiserStage(999);
  }

  @Test(expected = FatalException.class)
  public void testGetStage04() {
    stageUcc.visualiserStage(-1);
  }

  @Test(expected = BizException.class)
  public void confirmDataStage01() {
    stageAVerif.setAdresse("Avenue de l'avenue des sapins pli√©s"); // incorrect
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageUcc.confirmDataStage(stageAVerif, 1, 1, 1, 1);
  }

  @Test(expected = BizException.class)
  public void confirmDataStage02() {
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("123456"); // incorrect
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageUcc.confirmDataStage(stageAVerif, 1, 1, 1, 1);
  }

  @Test(expected = BizException.class)
  public void confirmDataStage03() {
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("12345"); // incorrect
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageUcc.confirmDataStage(stageAVerif, 1, 1, 1, 1);
  }

  @Test(expected = BizException.class)
  public void confirmDataStage04() {
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille(null);// incorrect
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageUcc.confirmDataStage(stageAVerif, 1, 1, 1, 1);
  }

  @Test(expected = BizException.class)
  public void confirmDataStage05() {
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(null); // incorrect
    stageUcc.confirmDataStage(stageAVerif, 1, 1, 1, 1);
  }

  @Test(expected = BizException.class)
  public void confirmDataStage06() {
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageUcc.confirmDataStage(stageAVerif, 1, 1, 99999, 1); // userDb null
  }


  @Test(expected = BizException.class)
  public void confirmDataStage07() {
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageAVerif.setEntreprise(9999999); // entrepriseDb null
    stageUcc.confirmDataStage(stageAVerif, 1, 1, 1, 1);
  }

  @Test(expected = BizException.class)
  public void confirmDataStage08() {
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageAVerif.setResponsable(Integer.MAX_VALUE);
    stageUcc.confirmDataStage(stageAVerif, 1, 1, 1, 1); // personneContactDb null
  }

  @Test(expected = BizException.class)
  public void confirmDataStage09() {
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageUcc.confirmDataStage(stageAVerif, Integer.MAX_VALUE, 1, 1, 1); // contactDb null
  }

  @Test(expected = OptimisticLockException.class)
  public void confirmDataStage10() {
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageUcc.confirmDataStage(stageAVerif, 1, 5, 1, 1); // contactNumVersion != contactDb
  }

  @Test(expected = OptimisticLockException.class)
  public void confirmDataStage11() {
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageUcc.confirmDataStage(stageAVerif, 1, 1, 1, 5); // userNumVersion != userDb
  }

  @Test(expected = BizException.class)
  public void confirmDataStage12() {
    // !userDb.getAnneeAcademique().equals(stage.getAnneeAcademique()
    stageAVerif.setAdresse("Avenue des marteaux");
    stageAVerif.setBoite("12345");
    stageAVerif.setCodePostal("1234");
    stageAVerif.setVille("Bruxelles");
    stageAVerif.setDateSignature(LocalDate.of(2018, 3, 3));
    stageAVerif.setEntreprise(2);
    stageAVerif.setResponsable(2);
    stageUcc.confirmDataStage(stageAVerif, 1, 1, 888, 888);
  }

  @Test(expected = BizException.class)
  public void confirmDataStage13() {
    // stageDao.getStage(idUser) != null
  }

  @Test(expected = BizException.class)
  public void confirmDataStage14() {
    // !pcDao.personneDeContactAppartientEntreprise(stage.getResponsable(),
    // stage.getEntreprise())
  }

  @Test(expected = BizException.class)
  public void confirmDataStage15() {
    // (contactDao.getContacts(idUser, Etat.STAGE_EN_ORDRE.getNumEtat()).size() != 0)
  }

  @Test(expected = BizException.class)
  public void confirmDataStage16() {
    // List<ContactDto> contactsAcceptes = contactDao.getContacts(idUser,
    // Etat.ACCEPTE.getNumEtat());
    // contactsAcceptes.size() != 1
  }

  @Test(expected = BizException.class)
  public void confirmDataStage17() {
    // ContactDto contactAccepteDb = contactsAcceptes.get(0);
    // contactAccepteDb.getIdContact() != idContact
  }

  @Test(expected = BizException.class)
  public void confirmDataStage18() {
    // ContactDto contactAccepteDb = contactsAcceptes.get(0);
    // contactAccepteDb.getEntreprise() != (stage.getEntreprise()
  }

  @Test(expected = BizException.class)
  public void confirmDataStage19() {
    // (stageDao.getStage(idUser) != null)
  }



}
