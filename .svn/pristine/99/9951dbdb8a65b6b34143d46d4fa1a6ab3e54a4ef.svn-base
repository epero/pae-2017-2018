$(function() {
	let whoami = null;
    
    
	function whoAmI(){
		config = {
			'data': {
				'action': 'whoami'
			},
			'success': function(reponse){
				if(reponse === null) {
					FrontEnd.displayPage('pageLogin');
				} else {
					whoami = reponse;
					FrontEnd.displayPage('pageCongrats');
				}
			}
		}
		util.myajax(config);
	}

	whoAmI();
	
	
	$('#btnLogin').click(function(){
		//const username = $('#inputLogin').val();
		//const password = $('#inputMdp').val();
		
		config = {
					'data': {
								'action': 'signin',
								'userAVerif': util.form2Json($('#formLogin'))
								//'pswd': password
					},
					'success': function(reponse){
						if(reponse == "ok"){
							whoami = $('#inputLogin').val();
							FrontEnd.displayPage('pageCongrats');
						} else {
							$('#notification').html('<div class="alert alert-dismissible bg-red text-center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Le nom d\'utilisateur ou le mot de passe est incorrect.</div>');
						}
					}
				 }
		util.myajax(config);
	});
	
	FrontEnd.onDisplayPage('pageCongrats', function(){
		$('#whoami').text(whoami);
	});
	
	
	$('#btnSignUp').click(function(){
		FrontEnd.displayPage('pageSignup');
	});

});