$(function() {
	//let whoami = null;
    whoAmI();
    
	function whoAmI(){
		config = {
			'data': {
				'action': 'whoami'
			},
			'success': function(reponse){
				if(reponse === null) {
					FrontEnd.displayPage('pageLogin');
				} else {
					whoami = reponse;
					FrontEnd.displayPage('pageCongrats');
				}
			}
		}
		util.myajax(config);
	}

	
	
	$('#btnLogin').click(function(){
		
		config = {
					'data': {
								'action': 'signin',
								'userAVerif': util.form2Json($('#formLogin'))
					},
					'success': function(reponse){
						if(reponse === null){
							$('.notification').html('<div class="alert alert-dismissible bg-red text-center"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Le nom d\'utilisateur ou le mot de passe est incorrect.</div>');
						} else {
							whoami = reponse;
							FrontEnd.displayPage('pageCongrats');
						}
					}
				 }
		util.myajax(config);
	});
	
	FrontEnd.onDisplayPage('pageCongrats', function(){
		$('#whoami').text(whoami.prenom +" " + whoami.nom);
	});
	
	
	$('#btnSignUp').click(function(){
		FrontEnd.displayPage('pageSignup');
	});
	
	$("button").click(function() {
		$('.notification').empty();
	});

});